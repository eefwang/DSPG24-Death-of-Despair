---
title: "Virginia OLS Regression"
author: "Elisabeth Wasserman"
date: "2024-06-20"
output: html_document
---
```{r}
library(dplyr)
library(here)
library(stargazer)
```


```{r import}
virginia_2018_2022 = read.csv(here("Data/merged_data", "virginia_2018_2022.csv"), sep = ",", header = TRUE)
```

```{r ruc}
# Assume 'data' is your dataframe and 'ruc_code' is the column with the Rural-Urban Continuum Codes
virginia_2018_2022 <- virginia_2018_2022 %>%
  mutate(ruc_group = case_when(
    RUCC_2023 %in% 1:3 ~ "Metro",
    RUCC_2023 %in% 4:9 ~ "Non-Metro",
    TRUE ~ "Unknown"  # This line handles any data that might not fit the defined categories
  ))
virginia_2018_2022$below_poverty_ratio = virginia_2018_2022$below_poverty_ratio*100 #make it a percentage %
virginia_2018_2022$ruc_group = as.factor(virginia_2018_2022$ruc_group)
```

```{r try}
virginia_ols_dod_1822 <- lm(DOD_death_rate ~ MHP_ratio + PCP_ratio + Median_household_income + Avg_mentally_unhealthy_days + Excessive_drinking + Teen_birth_rate + Poor_fair_health + Adult_smoking + Children_in_poverty + Severe_housing_problems + total_DSW + BA_higher_ratio + below_poverty_ratio + unemployed_pop_pe, data = virginia_2018_2022)

summary(virginia_ols_dod_1822)

virginia_ols_dod_1822_test1 <- lm(DOD_death_rate ~ MHP_ratio + Avg_mentally_unhealthy_days+ Teen_birth_rate + total_DSW + BA_higher_ratio + unemployed_pop_pe+ ruc_group + as.factor(Year), data = virginia_2018_2022)

summary(virginia_ols_dod_1822_test1)

virginia_ols_dod_1822_test2 <- lm(DOD_death_rate ~ below_poverty_ratio + BA_higher_ratio + unemployed_pop_pe+ ruc_group + as.factor(Year), data = virginia_2018_2022)

summary(virginia_ols_dod_1822_test2)

virginia_ols_dod_1822_test3 <- lm(DOD_death_rate ~ below_poverty_ratio + BA_higher_ratio + unemployed_pop_pe + total_DSW + Teen_birth_rate + ruc_group + as.factor(Year) , data = virginia_2018_2022)

summary(virginia_ols_dod_1822_test3)
```


```{r model}
virginia_ols_1 <- lm(DOD_death_rate ~ below_poverty_ratio + BA_higher_ratio + unemployed_pop_pe+as.factor(ruc_group)+as.factor(Year), data = virginia_2018_2022)

summary(virginia_ols_1)

virginia_ols_2 <- lm(DOD_death_rate ~ below_poverty_ratio + BA_higher_ratio + unemployed_pop_pe + total_male_pop+as.factor(ruc_group)+as.factor(Year), data = virginia_2018_2022)

summary(virginia_ols_2)

virginia_ols_3 <- lm(DOD_death_rate ~ below_poverty_ratio + BA_higher_ratio + unemployed_pop_pe + total_male_pop + total_black_pop + total_native_pop + total_asian_pacific_pop+ as.factor(ruc_group)+as.factor(Year), data = virginia_2018_2022)

summary(virginia_ols_3)

```

```{r}
stargazer(virginia_ols_1, virginia_ols_2, virginia_ols_3, type = "text")
```


```{r}
suppressd_va <- virginia_2018_2022 %>% #186 out of 665 is suppressed
  filter(is.na(DOD_death_rate))

suppressd_appa <- appalachia_2018_2022 %>%  #382 out of 2115 is suppressed
  filter(is.na(DOD_death_rate))
```


```{r}
virginia_ols_4 <- lm(DOD_death_rate ~ below_poverty_ratio + BA_higher_ratio + unemployed_pop_pe + total_male_pop + total_black_pop + total_native_pop + total_asian_pacific_pop+ as.factor(HPSAcode)+as.factor(Year), data = virginia_2018_2022)

summary(virginia_ols_4)

virginia_ols_5 <- lm(DOD_death_rate ~ below_poverty_ratio + BA_higher_ratio + unemployed_pop_pe + total_male_pop + total_black_pop + total_native_pop + total_asian_pacific_pop+ as.factor(HPSAcode)+as.factor(ruc_group)+as.factor(Year), data = virginia_2018_2022)

summary(virginia_ols_5)
```

```{r}
stargazer(virginia_ols_4, type = "text")
```

